% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/server_loop.R
\name{run_fedavg_mnist}
\alias{run_fedavg_mnist}
\title{Run FedAvg MNIST Experiment}
\usage{
run_fedavg_mnist(
  ds_train,
  ds_test,
  labels_train,
  model_fn = "2nn",
  partition = "nonIID",
  K = 100,
  C = 0.1,
  E = 5,
  batch_size = 10,
  lr_grid = c(0.03, 0.05, 0.1),
  target = 0.97,
  rounds = 3,
  seed = 123,
  device = "cpu",
  fedsgd = FALSE
)
}
\arguments{
\item{ds_train}{Training dataset.}

\item{ds_test}{Test dataset.}

\item{labels_train}{Training labels (for partitioning).}

\item{model_fn}{Model function: "2nn" for MLP or "cnn" for CNN.}

\item{partition}{Partition type: "IID" or "nonIID".}

\item{K}{Total number of clients.}

\item{C}{Fraction of clients per round.}

\item{E}{Local epochs.}

\item{batch_size}{Local batch size (use Inf for FedSGD).}

\item{lr_grid}{Learning rate grid for selection.}

\item{target}{Target accuracy for rounds-to-target (0.97 for 2NN, 0.99 for CNN).}

\item{rounds}{Number of communication rounds.}

\item{seed}{Random seed.}

\item{device}{Device to use ("cpu").}

\item{fedsgd}{If TRUE, run FedSGD mode (batch_size=Inf, E=1).}
}
\value{
A list containing \code{history} (data.frame) and \code{params} (final model parameters).
}
\description{
Runs the full Federated Averaging experiment on MNIST with paper-accurate settings.
}

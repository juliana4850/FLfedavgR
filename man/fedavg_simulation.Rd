% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fedavg_simulation.R
\name{fedavg_simulation}
\alias{fedavg_simulation}
\title{Generic FedAvg Simulation}
\usage{
fedavg_simulation(
  client_datasets,
  model_generator,
  evaluation_fn,
  rounds = 10,
  C = 0.1,
  E = 1,
  batch_size = 32,
  optimizer_generator = function(lr) function(p) torch::optim_sgd(p, lr = lr),
  lr_scheduler = function(r) 0.1,
  seed = 123,
  device = "cpu",
  log_file = NULL,
  save_model = NULL
)
}
\arguments{
\item{client_datasets}{A list of torch::dataset objects (one per client).}

\item{model_generator}{A function that returns a fresh instance of the model (torch::nn_module).}

\item{evaluation_fn}{A function(model, device) that returns a named list of metrics (e.g., list(accuracy=0.9)).}

\item{rounds}{Number of communication rounds.}

\item{C}{Fraction of clients to select per round.}

\item{E}{Number of local epochs.}

\item{batch_size}{Local batch size (Inf for full-batch).}

\item{optimizer_generator}{A function(lr) that returns an optimizer_fn for client_train_generic.}

\item{lr_scheduler}{A function(round) that returns the learning rate for that round.}

\item{seed}{Random seed.}

\item{device}{Device to use ("cpu" or "cuda").}

\item{log_file}{Optional path to CSV file for incremental logging of metrics.}

\item{save_model}{Optional path to save the final trained model (e.g., "model.pt"). If NULL, model is not saved.}
}
\value{
A list containing \code{history} (data.frame), \code{final_params}, and \code{final_model} (if save_model is specified).
}
\description{
Runs a Federated Averaging simulation on a generic dataset.
}
